[トップページに戻る](README.md)

# [FTKR_BattleActionTimes](FTKR_BattleActionTimes.js) プラグイン

戦闘中の行動回数を表示・操作するプラグインです。

ダウンロード: [FTKR_BattleActionTimes.js](https://raw.githubusercontent.com/futokoro/RPGMaker/master/FTKR_BattleActionTimes.js)

## 目次

以下の項目の順でプラグインの使い方を説明します。
1. [概要](#概要)
2. [プラグインの登録](#プラグインの登録)
1. [行動回数の表示](#行動回数の表示)
1. [行動回数を減らす特徴](#行動回数を減らす特徴)
1. [行動回数の最大値](#行動回数の最大値)
1. [行動回数の一時増減効果](#行動回数の一時増減効果)
1. [行動回数の消費無効化](#行動回数の消費無効化)
* [プラグインの更新履歴](#プラグインの更新履歴)
* [ライセンス](#ライセンス)

## 概要

このプラグインを導入すると、以下の機能を追加します。

* 戦闘シーンでパーティーメンバーの行動回数を表示
* 特徴によって増加する行動回数に最大値を設定
* アクター、職業、武器、防具、ステート、敵キャラに行動回数を減らす特徴の設定
* スキル・アイテムに、行動回数の一時増減させる効果の設定
* スキル・アイテム使用時の行動回数を消費しない効果の設定

このプラグインは、[FTKR_AlternatingTurnBattleプラグイン※v2.0.0以降](FTKR_AlternatingTurnBattle.ja.md)と組み合わせて使用することを想定して作成しています。

[目次に戻る](#目次)

## プラグインの登録

以下のプラグインと組み合わせる場合は、プラグイン管理画面で、以下の順の配置になるように登録してください。
```
FTKR_CustomSimpleActorStatus.js (ステータス表示を変更)
FTKR_AlternatingTurnBattle.js   (味方交互にターンが進むターン制戦闘システム)
↑このプラグインよりも上に登録↑
FTKR_BattleActionTimes.js
```

[目次に戻る](#目次)

# 行動回数の表示

アクターの行動回数は、プラグインパラメータ`Show AT`を有効に設定すると、戦闘中に表示させることができます。

プラグインパラメータ`Display AT Type`の設定により、表示方法を変えることができます。

## 数値で表示
プラグインパラメータ`Display AT Format`の記述内容に従い、戦闘中のステータスウィンドウに行動回数を数値で表示します。
表示位置は、名前の横です。

また、この設定の場合は、プラグインパラメータ`Display AT Gauge`を有効に設定することで、ゲージを表示できます。
ただし、最大値の設定が必要です。

## アイコン(現在値のみ)で表示
名前の下に重なる様に表示します。

## アイコン(現在値と最大値)で表示
名前の下に重なる様に表示します。
最大値の設定が必要です。

## FTKR_CustomSimpleActorStatusの機能で表示
当プラグインでは以下のコードをプラグインパラメータ`Actor Status Text*`に使用できます。

### コード：`actc`

アクターの行動回数を表示します。
表示方法は、`Display AT Type`の設定に従います。

[目次に戻る](#目次)

# 行動回数を減らす特徴

メモ欄に次のタグを記入することで、その特徴が反映されるアクターまたは敵キャラの行動回数を減らすことができます。

### タグ
`<FTKR_ACTION_MINUS x: y>`
* x : この特徴の効果が発生する確率(50% なら 50 と入力)
* y : 減少させる行動回数(正の数を入力)

### データベースでの対象
アクター、職業、武器、防具、敵キャラ、ステート

### 効果内容
「行動回数増加」の特徴によって増える行動回数と、この行動回数を減らす特徴によって減る行動回数の差分が、実際に１ターン内で行動できる回数になります。

タグで設定した確率に従い、ターンごとに判定し、行動回数を算出します。

この特徴によって行動回数が 0 回になったキャラは、戦闘中に行動できません。
また、この特徴によって、行動回数が 0 回よりも小さい値になることはありません。

### 入力例
```
<FTKR_ACTION_MINUS 100: 1>
```
100% の確率で、行動回数が 1 減少する。

```
<FTKR_ACTION_MINUS 50: 2>
```
50% の確率で、行動回数が 2 減少する。

[目次に戻る](#目次)

# 行動回数の最大値

## プラグインパラメータによる行動回数の最大値の設定
プラグインパラメータ`Default Max AT`で、行動回数の最大値を設定できます。

最大値を設定すると、行動回数増加の特徴が何個付いたとしても、その最大値までしか行動回数は増加しません。

最大値を設定した場合、行動回数の表示方法の「アイコン(現在値と最大値)」を使用できます。

## 特徴による行動回数の最大値の設定
メモ欄に次のタグを記入することで、個別に設定できます。

### タグ
`<FTKR_MAX_AT: x>`
* x : 行動回数の最大値

または

`<AltTB_MAX_AC: x>`

### データベースでの対象
アクター、エネミー

### 効果内容
アクターとエネミーに対して、行動回数の最大値を個別に設定できます。
この設定は、プラグインパラメータよりも優先します。

[目次に戻る](#目次)

# 行動回数の一時増減効果

## 使用効果による行動回数の一時増減
メモ欄に次のタグを記入することで、行動回数を一時的に増減させる効果を付与できます。

### タグ
`<FTKR_ADD_ACTION_TIMES x: y>`
* x : この効果が発生する確率(50% なら 50 と入力)
* y : 変化させる行動回数(正の数なら増加、負の数なら減少)

### データベースでの対象
スキル、アイテム

### 効果内容
このタグを記載した行動の対象者の行動回数を変更します。

この効果による行動回数の変化は、タグ記載した行動を実行したターンでのみ発生します。

### 入力例
```
<FTKR_ADD_ACTION_TIMES 100: 1>
```
100%の確率で、行動の対象者の行動回数を 1 増加させる。

## プラグインコマンドによる行動回数の一時増減
また、以下のプラグインコマンドでも一時的に増減させることができます。
プラグインコマンドには、確率の設定はありません。

### プラグインコマンド
```
FTKR_行動回数増加 [対象分類] [対象ID] [増加量]
FTKR_ADD_ACTION_TIMES [targetType] [targetId] [value]
```
または
```
AltTB_行動回数増加 [対象分類] [対象ID] [増加量]
AltTB_ADD_AC [targetType] [targetId] [value]
```

### パラメータの意味
#### 対象分類(targetType)
行動回数を増加させる対象をどのように選ぶかを指定します。
以下の文字列を入力してください。
* アクター または Actor
* パーティー または Party
* 敵グループ または Troop

#### 対象ID(targetId)
対象分類に合わせて、以下のIDを指定します。
* アクターなら、対象のアクターID。
* パーティーなら、パーティー先頭を 1 とした並び順。
* 敵グループなら、敵グループ先頭を 1 とした並び順。

\v[n] と指定することで変数 n の値を参照できます。
0 を指定した場合は、味方全体または敵全体を対象とします。

#### 増加量(value)
行動回数を増加させる値を指定します。
負の値を指定した場合、対象の行動回数が減少します。
\v[n] と指定することで変数 n の値を参照できます。

### 入力例
```
FTKR_行動回数増加 アクター 1 1
FTKR_ADD_ACTION_TIMES Actor 1 1
```
アクターID 1 の行動回数を 1 増加します。

```
FTKR_行動回数増加 パーティー 2 \v[5]
FTKR_ADD_ACTION_TIMES Party 2 \v[5]
```
パーティーの 2 番目のキャラの行動回数を 変数ID 5 の値分、増加します。

```
FTKR_行動回数増加 敵グループ 0 -1
FTKR_ADD_ACTION_TIMES Troop 0 -1
```
敵グループ全体の行動回数を 1 減らします。

## 行動の再設定について
なお、敵グループの行動回数を増加させても、そのままでは実際の行動は増えません。
なぜなら、増加した行動回数に対して、行動が設定されていないからです。

敵キャラに、増加した行動回数分の追加行動をさせるためには、次のプラグインコマンドを使い、行動を再設定してください。

### プラグインコマンド
```
FTKR_行動再設定 [対象分類] [対象ID]
FTKR_RESET_ACTIONS [targetType] [targetId]
```

### パラメータの意味
行動回数増加のプラグインコマンドと同じです。

### 入力例
```
FTKR_行動再設定 敵グループ 1
FTKR_RESET_ACTIONS Troop 1
```
敵グループの 1 番目の行動を再設定します。

[目次に戻る](#目次)

# 行動回数の消費無効化
メモ欄に次のタグを記入することで、行動回数を消費せずにスキルやアイテムを使用できます。

### タグ
`<FTKR_NoAT>`

または

`<AltTB_noAC>`

### データベースでの対象
スキル、アイテム

### 効果内容
このタグを設定したスキルやアイテムは、使用しても行動回数を消費しません。
行動回数が１回のアクターでも、このタグを設定したスキルやアイテムは１ターン中に何回でも使用できるため、別の手段(例えば消費MPや消費TPなど)で選択できる回数を制限させてください。

[目次に戻る](#目次)

# スクリプト

このプラグインでは、以下のスクリプトが使用できます。

## 行動回数の現在値の取得
アクターID n の場合

`$gameActors.actor(n).numActions()`

パーティーの n 番目のキャラの場合

`$gameParty.members()[n-1].numActions()`

敵グループの n 番目のキャラの場合

`$gameTroop.members()[n-1].numActions()`

## 行動回数の基準値の取得
ここでの基準値とは、アクターやエネミーの特徴で設定されている行動回数のことを意味します。
行動回数の増減の特徴が 100% 以外の確率に設定している場合は、このスクリプトを実行するたびに確率を計算するため値は変わります。

アクターID n の場合

`$gameActors.actor(n).makeActionTimes()`

パーティーおよび敵グループの場合は、`$gameActors.actor(n)`の部分を変更のこと。

## 行動回数の最大値の取得
アクターID n の場合

`$gameActors.actor(n).maxActionTime()`

パーティーおよび敵グループの場合は、`$gameActors.actor(n)`の部分を変更のこと。

[目次に戻る](#目次)

# プラグインの更新履歴

| バージョン | 公開日 | 更新内容 |
| --- | --- | --- |
| [ver1.0.2](FTKR_BattleActionTimes.js) | 2018/12/19 | 戦闘行動の強制を実行するとエラーになる不具合を修正 |
| ver1.0.1 | 2018/12/03 | プラグインコマンドの誤記修正 |
| ver1.0.0 | 2018/12/02 | FTKR_AlternatingTurnBattle v1.6.2 の、行動回数に関する処理を独立。処理を見直して別プラグインとして作成 |

# ライセンス

本プラグインはMITライセンスのもとで公開しています。

[The MIT License (MIT)](https://opensource.org/licenses/mit-license.php)

#
[目次に戻る](#目次)

[トップページに戻る](README.md)