[トップページに戻る](README.md)

# [FTKR_ExItemConfig_Damage](FTKR_ExItemConfig_Damage.js) プラグイン

アイテムとスキルのダメージ処理を拡張するプラグインです。<br>
本プラグインは、FTKR_SkillExpansion.jsと組み合わせて使用できません。

ダウンロード: [FTKR_ExItemConfig_Damage.js](https://raw.githubusercontent.com/futokoro/RPGMaker/master/FTKR_ExItemConfig_Damage.js)

## 目次

本プラグインを実装することで、アイテムやスキルによって与えるダメージを以下の仕様に変更します。

```
[ダメージ] = [ダメージID 0 のダメージ] + [ダメージID 1 のダメージ] + ...
```

各ダメージIDのダメージは、それぞれ、別の設定値を持ち、別に計算します。

## ダメージの設定

本プラグインを適用することで、スキルによって与えるダメージを、以下の仕様に変更します。

```
[ダメージ] = [ダメージID 0 のダメージ] + [ダメージID 1 のダメージ] + ...
```

ダメージID毎に、攻撃と防御によるダメージ計算を行い、その結果の合計値を最終的なダメージとして相手に与えます。

例えば、「複数の属性を持ち、かつ属性毎に与えるダメージが異なるスキル」や「物理ダメージと魔法ダメージを併せ持つスキル」などを作ることができます。

### ダメージIDの設定
スキルに以下のノートタグを追記することで、各ダメージIDを設定できます。

```
<EIC ダメージID: x>
code
</EIC ダメージID>
```

ダメージID毎にスキルIDを設定することで、そのスキルIDの属性、ダメージ計算式、命中タイプ、ダメージタイプを元に各ダメージIDのダメージ計算を行います。

また、そのスキルIDの使用効果や得TPについても、ダメージとともに発生します。
ダメージID0 は、ベースとなるスキルのデータベース上の設定が反映されます。

注意：ダメージIDを追加する場合は、必ずID1 から順番に追加してください。

### code に使用できる項目
```
SkillId: y
スキルID: y
```
スキルID y のスキル設定をコピーします。
基本的に、このコードを使って、各ダメージIDの設定を作成します。

```
ElementId: y1,y2,...
属性ID: y1,y2,...
```
属性ID y1,y2,...で指定した属性を追加します。

```
DamageRate: eval
ダメージ倍率: 計算式
```
ダメージ倍率を 計算式(eval)で設定した値(%)に変更します。
この値をダメージ計算式の結果に対して積算したものがダメージになります。
設定しない場合は、プラグインパラメータ`<Default Rate>`の値を使用します。

```
CriticalRate: eval
クリティカル倍率: 計算式
```
クリティカルのダメージ倍率を 計算式(eval)で設定した値(%)に変更します。
設定しない場合は、プラグインパラメータ`<Critical Rate>`の値を使用します。

```
Trait Elements: type1,type2,...
特徴の属性追加: type1,type2,...
```
type1,type2,... で指定した対象の特長欄の属性を追加します。
type* で指定できる文字は、Actor,Class,Weapon,Armor,States です。

```
Enabled: eval
有効条件: 計算式
```
対象のダメージID を計算式で設定した条件で有効にします。
設定しない場合は、常に有効です。
ダメージID 0 に対しては設定できません。
有効になっていない場合は、ダメージに反映しません。


### 計算式(eval)の値について
計算式は、ダメージ計算式のように、計算式を入力することで、固定値以外の値を
使用することができます。以下のコードを使用できます。
* a.param - 使用者のパラメータを参照します。(a.atk で使用者の攻撃力)
* s[x]    - スイッチID x の状態を参照します。
* v[x]    - 変数ID x の値を参照します。
* iv[x]   - アイテムのセルフ変数ID x の値を参照します。(*1)

(*1) セルフ変数を使用する場合は、FTKR_ItemSelfVariables.jsが必要です。


### 入力例
ダメージID1 として、使用者のレベルが11以上かつスイッチID1がONの時に、スキルID10のスキルのダメージを追加します。
ダメージ倍率は50%、クリティカルダメージは400%に変更します。
属性や命中タイプ、計算式等は、スキルID10のものを使用します。

```
<EIC ダメージID: 1>
スキルId: 10
ダメージ倍率: 50
クリティカル倍率: 400
有効条件: a.level > 10 && s[1]
</EIC ダメージID>
```

### プラグインパラメータの設定項目
```
<Critical For Each>
```
クリティカルの判定を、ダメージID0 の最初の1回だけにするか、それともダメージID毎に判定するか選べます。

## 属性ダメージの計算方法について

プラグインパラメータ`<Element Damage Calc>`の設定値により、複数の属性を持った攻撃をした場合の、防御側の有効度の計算方法を変更することができます。

変更できる計算方法は、最大、平均、累積、最小の４種類です。

###  <0:最大>
防御側の該当する属性有効度の最大値が最終的なダメージ倍率になります。(ツクールMVの標準方式)

例) 物理＋炎の2属性攻撃で、防御側の有効度が物理50%、炎70%の場合<br>
最終的な有効度は `70% ( = max(50%, 70%) )`

###  <1:平均>
防御側の該当する属性有効度の平均値が最終的なダメージ倍率になります。

例) 物理＋炎の2属性攻撃で、防御側の有効度が物理50%、炎70%の場合<br>
最終的な有効度は `60% ( = (50% + 70%) / 2 )`

###  <2:累積>
防御側の該当する属性有効度を累積した値が最終的なダメージ倍率になります。

例) 物理＋炎の2属性攻撃で、防御側の有効度が物理50%、炎70%の場合<br>
最終的な有効度は `35% ( = 50% × 70% )`

###  <3:最小>
防御側の該当する属性有効度の最小値が最終的なダメージ倍率になります。

例) 物理＋炎の2属性攻撃で、防御側の有効度が物理50%、炎70%の場合<br>
最終的な有効度は `50% ( = min(50%, 70%) )`

なお、この計算は、ダメージID毎に別に行われますので注意してください。

### 設定例
以下の2パターンは、防御側の有効度の設定が無ければ同じダメージですが、有効度の設定がある場合は最終的なダメージが変わります。

#### パターン1 ダメージID 0 のみ
* 属性物理＋炎
* 計算式200

防御側の有効度が物理50%、炎70%の場合で最大設定の場合
```
200 * 70% = 140ダメージ
```

#### パターン2 ダメージID 0 と ダメージID 1
* ID0 属性物理
* ID0 計算式100
* ID1 属性炎
* ID1 計算式100

防御側の有効度が物理50%、炎70%の場合で最大設定の場合
```
100 * 50% + 100 * 70% = 120ダメージ
```


[目次に戻る](#目次)

## プラグインの更新履歴

| バージョン | 公開日 | 更新内容 |
| --- | --- | --- |
| [ver1.1.0](FTKR_ExItemConfig_Damage.js) | 2018/08/05 | 属性ダメージ計算時に100%の属性有効度を除外できる機能を追加 |
| ver1.0.1 | 2017/04/29 | FTKR_ItemSelfVariables の v1.1.0以降に対応 |
| ver1.0.0 | 2017/04/14 | 初版公開 |

## ライセンス

本プラグインはMITライセンスのもとで公開しています。

[The MIT License (MIT)](https://opensource.org/licenses/mit-license.php)

#
[目次に戻る](#目次)

[トップページに戻る](README.md)